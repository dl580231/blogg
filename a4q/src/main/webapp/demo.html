<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>发布</title>
    <style>
    	
    </style>
</head>

<body>
	<div class="post_body post_body_min_h">
          <strong>案例简述</strong><br>
本章节主要了解Java虚拟机从哪里寻找class文件并且读取class内字节码<br>
<br>
<strong>环境准备</strong><br>
1、jdk&nbsp;1.8.0<br>
2、IntelliJ&nbsp;IDEA&nbsp;Community&nbsp;Edition&nbsp;2018.3.1&nbsp;x64<br>
3、Notepad++&nbsp;（插件安装HEX-Editor，用于查看class字节）<br>
<br>
<strong>配置信息</strong><br>
1、调试配置<br>
2.1、配置位置：Run/Debug&nbsp;Configurations&nbsp;-&gt;&nbsp;program&nbsp;arguments<br>
2.2、配置内容：-Xjre&nbsp;"C:\Program&nbsp;Files\Java\jdk1.8.0_161\jre"&nbsp;E:\itstack\git\istack-demo\itstack-demo-jvm\itstack-demo-jvm-02\target\test-classes\org\itstack\demo\test\HelloWorld<br>
<br>
<strong>代码示例</strong><br>
<img src="https://img-bbs.csdn.net/upload/201905/06/1557118924_750145.png" alt="" class="csdn-preview-img"><br>
<br>
pom.xml<br>
<div><div id="highlighter_282481" class="syntaxhighlighter  xml "><div class="toolbar"><span>XML/HTML code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!--&nbsp;命令行参数解析器&nbsp;--&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;com.beust&lt;/</code><code class="xml keyword">groupId</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;jcommander&lt;/</code><code class="xml keyword">artifactId</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">version</code><code class="xml plain">&gt;1.72&lt;/</code><code class="xml keyword">version</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">dependency</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div><br>
<br>
CompositeEntry.java<br>
<div><div id="highlighter_398986" class="syntaxhighlighter  java"><div class="toolbar"><span>Java code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.Entry;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.File;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.IOException;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.util.ArrayList;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.util.List;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="java preprocessor">/**</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;http://www.itstack.org</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;create&nbsp;by&nbsp;fuzhengwei&nbsp;on&nbsp;2019/4/24</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number14 index13 alt1"><code class="java keyword">public</code>&nbsp;<code class="java keyword">class</code>&nbsp;<code class="java plain">CompositeEntry&nbsp;</code><code class="java keyword">implements</code>&nbsp;<code class="java plain">Entry&nbsp;{</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java keyword">final</code>&nbsp;<code class="java plain">List&lt;Entry&gt;&nbsp;entryList&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">ArrayList&lt;&gt;();</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java plain">CompositeEntry(String&nbsp;pathList)&nbsp;{</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String[]&nbsp;paths&nbsp;=&nbsp;pathList.split(File.pathSeparator);</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code>&nbsp;<code class="java plain">(String&nbsp;path&nbsp;:&nbsp;paths)&nbsp;{</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">entryList.add(Entry.create(path));</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java keyword">byte</code><code class="java plain">[]&nbsp;readClass(String&nbsp;className)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">IOException&nbsp;{</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code>&nbsp;<code class="java plain">(Entry&nbsp;entry&nbsp;:&nbsp;entryList)&nbsp;{</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">entry.readClass(className);</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//ignored</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">throw</code>&nbsp;<code class="java keyword">new</code>&nbsp;<code class="java plain">IOException(</code><code class="java string">"class&nbsp;not&nbsp;found&nbsp;"</code>&nbsp;<code class="java plain">+&nbsp;className);</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java plain">String&nbsp;toString()&nbsp;{</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String[]&nbsp;strs&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">String[entryList.size()];</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code>&nbsp;<code class="java plain">(</code><code class="java keyword">int</code>&nbsp;<code class="java plain">i&nbsp;=&nbsp;</code><code class="java value">0</code><code class="java plain">;&nbsp;i&nbsp;&lt;&nbsp;entryList.size();&nbsp;i++)&nbsp;{</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">strs[i]&nbsp;=&nbsp;entryList.get(i).toString();</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">String.join(File.pathSeparator,&nbsp;strs);</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number47 index46 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div><br>
<br>
DirEntry.java<br>
<div><div id="highlighter_324668" class="syntaxhighlighter  java"><div class="toolbar"><span>Java code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.Entry;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.IOException;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.Files;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.Path;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.Paths;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="java preprocessor">/**</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;http://www.itstack.org</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;create&nbsp;by&nbsp;fuzhengwei&nbsp;on&nbsp;2019/4/24</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;目录形式的类路径</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number15 index14 alt2"><code class="java keyword">public</code>&nbsp;<code class="java keyword">class</code>&nbsp;<code class="java plain">DirEntry&nbsp;</code><code class="java keyword">implements</code>&nbsp;<code class="java plain">Entry&nbsp;{</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java plain">Path&nbsp;absolutePath;</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java plain">DirEntry(String&nbsp;path){</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//获取绝对路径</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">this</code><code class="java plain">.absolutePath&nbsp;=&nbsp;Paths.get(path).toAbsolutePath();</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java keyword">byte</code><code class="java plain">[]&nbsp;readClass(String&nbsp;className)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">IOException&nbsp;{</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">Files.readAllBytes(absolutePath.resolve(className));</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java plain">String&nbsp;toString()&nbsp;{</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java keyword">this</code><code class="java plain">.absolutePath.toString();</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number33 index32 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div><br>
<br>
WildcardEntry.java<br>
<div><div id="highlighter_494208" class="syntaxhighlighter  java"><div class="toolbar"><span>Java code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.Entry;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.File;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.IOException;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.Files;</code></div><div class="line number8 index7 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.Path;</code></div><div class="line number9 index8 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.Paths;</code></div><div class="line number10 index9 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.util.stream.Collectors;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="java preprocessor">/**</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;http://www.itstack.org</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;create&nbsp;by&nbsp;fuzhengwei&nbsp;on&nbsp;2019/4/24</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;通配符类路径，继承CompositeEntry</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number17 index16 alt2"><code class="java keyword">public</code>&nbsp;<code class="java keyword">class</code>&nbsp;<code class="java plain">WildcardEntry&nbsp;</code><code class="java keyword">extends</code>&nbsp;<code class="java plain">CompositeEntry&nbsp;{</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java plain">WildcardEntry(String&nbsp;path)&nbsp;{</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">super</code><code class="java plain">(toPathList(path));</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java keyword">static</code>&nbsp;<code class="java plain">String&nbsp;toPathList(String&nbsp;wildcardPath)&nbsp;{</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;baseDir&nbsp;=&nbsp;wildcardPath.replace(</code><code class="java string">"*"</code><code class="java plain">,&nbsp;</code><code class="java string">""</code><code class="java plain">);&nbsp;</code><code class="java comments">//&nbsp;remove&nbsp;*</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">Files.walk(Paths.get(baseDir))</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.filter(Files::isRegularFile)</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.map(Path::toString)</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.filter(p&nbsp;-&gt;&nbsp;p.endsWith(</code><code class="java string">".jar"</code><code class="java plain">)&nbsp;||&nbsp;p.endsWith(</code><code class="java string">".JAR"</code><code class="java plain">))</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">.collect(Collectors.joining(File.pathSeparator));</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(IOException&nbsp;e)&nbsp;{</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java string">""</code><code class="java plain">;</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number35 index34 alt2">&nbsp;</div><div class="line number36 index35 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div><br>
<br>
ZipEntry.java<br>
<div><div id="highlighter_414160" class="syntaxhighlighter  java"><div class="toolbar"><span>Java code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.Entry;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.IOException;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.*;</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java preprocessor">/**</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;http://www.itstack.org</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;create&nbsp;by&nbsp;fuzhengwei&nbsp;on&nbsp;2019/4/24</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;zip/zar文件形式类路径</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number13 index12 alt2"><code class="java keyword">public</code>&nbsp;<code class="java keyword">class</code>&nbsp;<code class="java plain">ZipEntry&nbsp;</code><code class="java keyword">implements</code>&nbsp;<code class="java plain">Entry&nbsp;{</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java plain">Path&nbsp;absolutePath;</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java plain">ZipEntry(String&nbsp;path)&nbsp;{</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//获取绝对路径</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">this</code><code class="java plain">.absolutePath&nbsp;=&nbsp;Paths.get(path).toAbsolutePath();</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java keyword">byte</code><code class="java plain">[]&nbsp;readClass(String&nbsp;className)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">IOException&nbsp;{</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">(FileSystem&nbsp;zipFs&nbsp;=&nbsp;FileSystems.newFileSystem(absolutePath,&nbsp;</code><code class="java keyword">null</code><code class="java plain">))&nbsp;{</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">Files.readAllBytes(zipFs.getPath(className));</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Override</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java plain">String&nbsp;toString()&nbsp;{</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java keyword">this</code><code class="java plain">.absolutePath.toString();</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div><br>
<br>
Classpath.java<br>
<div><div id="highlighter_888281" class="syntaxhighlighter  java"><div class="toolbar"><span>Java code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl.WildcardEntry;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.File;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.Files;</code></div><div class="line number7 index6 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.nio.file.Paths;</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="java preprocessor">/**</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;http://www.itstack.org</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;create&nbsp;by&nbsp;fuzhengwei&nbsp;on&nbsp;2019/4/24</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;类路径</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number14 index13 alt1"><code class="java keyword">public</code>&nbsp;<code class="java keyword">class</code>&nbsp;<code class="java plain">Classpath&nbsp;{</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java plain">Entry&nbsp;bootstrapClasspath;&nbsp;&nbsp;</code><code class="java comments">//启动类路径</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java plain">Entry&nbsp;extensionClasspath;&nbsp;&nbsp;</code><code class="java comments">//扩展类路径</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java plain">Entry&nbsp;userClasspath;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//用户类路径</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java plain">Classpath(String&nbsp;jreOption,&nbsp;String&nbsp;cpOption)&nbsp;{</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//启动类&amp;扩展类&nbsp;"C:\Program&nbsp;Files\Java\jdk1.8.0_161\jre"</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">bootstrapAndExtensionClasspath(jreOption);</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//用户类&nbsp;E:\..\org\itstack\demo\test\HelloWorld</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">parseUserClasspath(cpOption);</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">bootstrapAndExtensionClasspath(String&nbsp;jreOption)&nbsp;{</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;jreDir&nbsp;=&nbsp;getJreDir(jreOption);</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//..jre/lib/*</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;jreLibPath&nbsp;=&nbsp;Paths.get(jreDir,&nbsp;</code><code class="java string">"lib"</code><code class="java plain">)&nbsp;+&nbsp;File.separator&nbsp;+&nbsp;</code><code class="java string">"*"</code><code class="java plain">;</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">bootstrapClasspath&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">WildcardEntry(jreLibPath);</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//..jre/lib/ext/*</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;jreExtPath&nbsp;=&nbsp;Paths.get(jreDir,&nbsp;</code><code class="java string">"lib"</code><code class="java plain">,&nbsp;</code><code class="java string">"ext"</code><code class="java plain">)&nbsp;+&nbsp;File.separator&nbsp;+&nbsp;</code><code class="java string">"*"</code><code class="java plain">;</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">extensionClasspath&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">WildcardEntry(jreExtPath);</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java keyword">static</code>&nbsp;<code class="java plain">String&nbsp;getJreDir(String&nbsp;jreOption)&nbsp;{</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(jreOption&nbsp;!=&nbsp;</code><code class="java keyword">null</code>&nbsp;<code class="java plain">&amp;&amp;&nbsp;Files.exists(Paths.get(jreOption)))&nbsp;{</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">jreOption;</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(Files.exists(Paths.get(</code><code class="java string">"./jre"</code><code class="java plain">)))&nbsp;{</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java string">"./jre"</code><code class="java plain">;</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;jh&nbsp;=&nbsp;System.getenv(</code><code class="java string">"JAVA_HOME"</code><code class="java plain">);</code></div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(jh&nbsp;!=&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">Paths.get(jh,&nbsp;</code><code class="java string">"jre"</code><code class="java plain">).toString();</code></div><div class="line number51 index50 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number52 index51 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">throw</code>&nbsp;<code class="java keyword">new</code>&nbsp;<code class="java plain">RuntimeException(</code><code class="java string">"Can&nbsp;not&nbsp;find&nbsp;JRE&nbsp;folder!"</code><code class="java plain">);</code></div><div class="line number53 index52 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number54 index53 alt1">&nbsp;</div><div class="line number55 index54 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">private</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">parseUserClasspath(String&nbsp;cpOption)&nbsp;{</code></div><div class="line number56 index55 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(cpOption&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number57 index56 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cpOption&nbsp;=&nbsp;</code><code class="java string">"."</code><code class="java plain">;</code></div><div class="line number58 index57 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number59 index58 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">userClasspath&nbsp;=&nbsp;Entry.create(cpOption);</code></div><div class="line number60 index59 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number61 index60 alt2">&nbsp;</div><div class="line number62 index61 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">public</code>&nbsp;<code class="java keyword">byte</code><code class="java plain">[]&nbsp;readClass(String&nbsp;className)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">Exception&nbsp;{</code></div><div class="line number63 index62 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">className&nbsp;=&nbsp;className&nbsp;+&nbsp;</code><code class="java string">".class"</code><code class="java plain">;</code></div><div class="line number64 index63 alt1">&nbsp;</div><div class="line number65 index64 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//[readClass]启动类路径</code></div><div class="line number66 index65 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number67 index66 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">bootstrapClasspath.readClass(className);</code></div><div class="line number68 index67 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number69 index68 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//ignored</code></div><div class="line number70 index69 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number71 index70 alt2">&nbsp;</div><div class="line number72 index71 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//[readClass]扩展类路径</code></div><div class="line number73 index72 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number74 index73 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">extensionClasspath.readClass(className);</code></div><div class="line number75 index74 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;ignored)&nbsp;{</code></div><div class="line number76 index75 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//ignored</code></div><div class="line number77 index76 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number78 index77 alt1">&nbsp;</div><div class="line number79 index78 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//[readClass]用户类路径</code></div><div class="line number80 index79 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">userClasspath.readClass(className);</code></div><div class="line number81 index80 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number82 index81 alt1">&nbsp;</div><div class="line number83 index82 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div><br>
<br>
Entry.java<br>
<div><div id="highlighter_59271" class="syntaxhighlighter  java"><div class="toolbar"><span>Java code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl.CompositeEntry;</code></div><div class="line number4 index3 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl.DirEntry;</code></div><div class="line number5 index4 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl.WildcardEntry;</code></div><div class="line number6 index5 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">org.itstack.demo.jvm.classpath.impl.ZipEntry;</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.File;</code></div><div class="line number9 index8 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.io.IOException;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="java preprocessor">/**</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;http://www.itstack.org</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;create&nbsp;by&nbsp;fuzhengwei&nbsp;on&nbsp;2019/4/24</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;类路径接口</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number16 index15 alt1"><code class="java keyword">public</code>&nbsp;<code class="java keyword">interface</code>&nbsp;<code class="java plain">Entry&nbsp;{</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">byte</code><code class="java plain">[]&nbsp;readClass(String&nbsp;className)&nbsp;</code><code class="java keyword">throws</code>&nbsp;<code class="java plain">IOException;</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">static</code>&nbsp;<code class="java plain">Entry&nbsp;create(String&nbsp;path)&nbsp;{</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//File.pathSeparator；路径分隔符(win\linux)</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(path.contains(File.pathSeparator))&nbsp;{</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java keyword">new</code>&nbsp;<code class="java plain">CompositeEntry(path);</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(path.endsWith(</code><code class="java string">"*"</code><code class="java plain">))&nbsp;{</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java keyword">new</code>&nbsp;<code class="java plain">WildcardEntry(path);</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(path.endsWith(</code><code class="java string">".jar"</code><code class="java plain">)&nbsp;||&nbsp;path.endsWith(</code><code class="java string">".JAR"</code><code class="java plain">)&nbsp;||</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">path.endsWith(</code><code class="java string">".zip"</code><code class="java plain">)&nbsp;||&nbsp;path.endsWith(</code><code class="java string">".ZIP"</code><code class="java plain">))&nbsp;{</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java keyword">new</code>&nbsp;<code class="java plain">ZipEntry(path);</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number35 index34 alt2">&nbsp;</div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java keyword">new</code>&nbsp;<code class="java plain">DirEntry(path);</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div><br>
<br>
Cmd.java<br>
<div><div id="highlighter_553317" class="syntaxhighlighter  java"><div class="toolbar"><span>Java code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code>&nbsp;<code class="java plain">org.itstack.demo.jvm;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java keyword">import</code>&nbsp;<code class="java plain">com.beust.jcommander.JCommander;</code></div><div class="line number4 index3 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">com.beust.jcommander.Parameter;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="java keyword">import</code>&nbsp;<code class="java plain">java.util.List;</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="java preprocessor">/**</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;http://www.itstack.org</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*&nbsp;create&nbsp;by&nbsp;fuzhengwei&nbsp;on&nbsp;2019/4/24</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;</code><code class="java preprocessor">*/</code></div><div class="line number12 index11 alt1"><code class="java keyword">public</code>&nbsp;<code class="java keyword">class</code>&nbsp;<code class="java plain">Cmd&nbsp;{</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Parameter</code><code class="java plain">(names&nbsp;=&nbsp;{</code><code class="java string">"-?"</code><code class="java plain">,&nbsp;</code><code class="java string">"-help"</code><code class="java plain">},&nbsp;description&nbsp;=&nbsp;</code><code class="java string">"print&nbsp;help&nbsp;message"</code><code class="java plain">,&nbsp;order&nbsp;=&nbsp;</code><code class="java value">3</code><code class="java plain">,&nbsp;help&nbsp;=&nbsp;</code><code class="java keyword">true</code><code class="java plain">)</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">boolean</code>&nbsp;<code class="java plain">helpFlag&nbsp;=&nbsp;</code><code class="java keyword">false</code><code class="java plain">;</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Parameter</code><code class="java plain">(names&nbsp;=&nbsp;</code><code class="java string">"-version"</code><code class="java plain">,&nbsp;description&nbsp;=&nbsp;</code><code class="java string">"print&nbsp;version&nbsp;and&nbsp;exit"</code><code class="java plain">,&nbsp;order&nbsp;=&nbsp;</code><code class="java value">2</code><code class="java plain">)</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">boolean</code>&nbsp;<code class="java plain">versionFlag&nbsp;=&nbsp;</code><code class="java keyword">false</code><code class="java plain">;</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Parameter</code><code class="java plain">(names&nbsp;=&nbsp;{</code><code class="java string">"-cp"</code><code class="java plain">,&nbsp;</code><code class="java string">"-classpath"</code><code class="java plain">},&nbsp;description&nbsp;=&nbsp;</code><code class="java string">"classpath"</code><code class="java plain">,&nbsp;order&nbsp;=&nbsp;</code><code class="java value">1</code><code class="java plain">)</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;classpath;</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Parameter</code><code class="java plain">(names&nbsp;=&nbsp;</code><code class="java string">"-Xjre"</code><code class="java plain">,&nbsp;description&nbsp;=&nbsp;</code><code class="java string">"path&nbsp;to&nbsp;jre"</code><code class="java plain">,&nbsp;order&nbsp;=&nbsp;</code><code class="java value">4</code><code class="java plain">)</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;jre;</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java color1">@Parameter</code><code class="java plain">(description&nbsp;=&nbsp;</code><code class="java string">"main&nbsp;class&nbsp;and&nbsp;args"</code><code class="java plain">)</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">List&lt;String&gt;&nbsp;mainClassAndArgs;</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">boolean</code>&nbsp;<code class="java plain">ok;</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">String&nbsp;getMainClass()&nbsp;{</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">mainClassAndArgs&nbsp;!=&nbsp;</code><code class="java keyword">null</code>&nbsp;<code class="java plain">&amp;&amp;&nbsp;!mainClassAndArgs.isEmpty()</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">?&nbsp;mainClassAndArgs.get(</code><code class="java value">0</code><code class="java plain">)</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">:&nbsp;</code><code class="java keyword">null</code><code class="java plain">;</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">List&lt;String&gt;&nbsp;getAppArgs()&nbsp;{</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">mainClassAndArgs&nbsp;!=&nbsp;</code><code class="java keyword">null</code>&nbsp;<code class="java plain">&amp;&amp;&nbsp;mainClassAndArgs.size()&nbsp;&gt;&nbsp;</code><code class="java value">1</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">?&nbsp;mainClassAndArgs.subList(</code><code class="java value">1</code><code class="java plain">,&nbsp;mainClassAndArgs.size())</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">:&nbsp;</code><code class="java keyword">null</code><code class="java plain">;</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">static</code>&nbsp;<code class="java plain">Cmd&nbsp;parse(String[]&nbsp;argv)&nbsp;{</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">Cmd&nbsp;args&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">Cmd();</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">JCommander&nbsp;cmd&nbsp;=&nbsp;JCommander.newBuilder().addObject(args).build();</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cmd.parse(argv);</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">args.ok&nbsp;=&nbsp;</code><code class="java keyword">true</code><code class="java plain">;</code></div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">args;</code></div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number51 index50 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div><br>
<br>
<strong>测试结果</strong>&nbsp;验证Notepad++&nbsp;打开HelloWorld.class，在'插件'工具中选HEX-Editor<br>
<div><div id="highlighter_307417" class="syntaxhighlighter  text"><div class="toolbar"><span>Plain Text code</span><span class="clipboardCopyBtn" title="复制"><div class="d_clip_button"></div></span><span class="clipboardWindowBtn"><a href="#clipboardWindow" title="源码">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="text plain">classpath：org.itstack.demo.jvm.classpath.Classpath@4bf558aa&nbsp;class：E:\itstack\git\istack-demo\itstack-demo-jvm\itstack-demo-jvm-02\target\test-classes\org\itstack\demo\test\HelloWorld&nbsp;args：null</code></div><div class="line number2 index1 alt1"><code class="text plain">classData：</code></div><div class="line number3 index2 alt2"><code class="text plain">ca&nbsp;fe&nbsp;ba&nbsp;be&nbsp;00&nbsp;00&nbsp;00&nbsp;34&nbsp;00&nbsp;22&nbsp;0a&nbsp;00&nbsp;06&nbsp;00&nbsp;14&nbsp;09&nbsp;</code></div><div class="line number4 index3 alt1"><code class="text plain">00&nbsp;15&nbsp;00&nbsp;16&nbsp;08&nbsp;00&nbsp;17&nbsp;0a&nbsp;00&nbsp;18&nbsp;00&nbsp;19&nbsp;07&nbsp;00&nbsp;1a&nbsp;07&nbsp;</code></div><div class="line number5 index4 alt2"><code class="text plain">00&nbsp;1b&nbsp;01&nbsp;00&nbsp;06&nbsp;3c&nbsp;69&nbsp;6e&nbsp;69&nbsp;74&nbsp;3e&nbsp;01&nbsp;00&nbsp;03&nbsp;28&nbsp;29&nbsp;</code></div><div class="line number6 index5 alt1"><code class="text plain">56&nbsp;01&nbsp;00&nbsp;04&nbsp;43&nbsp;6f&nbsp;64&nbsp;65&nbsp;01&nbsp;00&nbsp;0f&nbsp;4c&nbsp;69&nbsp;6e&nbsp;65&nbsp;4e&nbsp;</code></div><div class="line number7 index6 alt2"><code class="text plain">75&nbsp;6d&nbsp;62&nbsp;65&nbsp;72&nbsp;54&nbsp;61&nbsp;62&nbsp;6c&nbsp;65&nbsp;01&nbsp;00&nbsp;12&nbsp;4c&nbsp;6f&nbsp;63&nbsp;</code></div><div class="line number8 index7 alt1"><code class="text plain">61&nbsp;6c&nbsp;56&nbsp;61&nbsp;72&nbsp;69&nbsp;61&nbsp;62&nbsp;6c&nbsp;65&nbsp;54&nbsp;61&nbsp;62&nbsp;6c&nbsp;65&nbsp;01&nbsp;</code></div><div class="line number9 index8 alt2"><code class="text plain">00&nbsp;04&nbsp;74&nbsp;68&nbsp;69&nbsp;73&nbsp;01&nbsp;00&nbsp;22&nbsp;4c&nbsp;6f&nbsp;72&nbsp;67&nbsp;2f&nbsp;69&nbsp;74&nbsp;</code></div><div class="line number10 index9 alt1"><code class="text plain">73&nbsp;74&nbsp;61&nbsp;63&nbsp;6b&nbsp;2f&nbsp;64&nbsp;65&nbsp;6d&nbsp;6f&nbsp;2f&nbsp;74&nbsp;65&nbsp;73&nbsp;74&nbsp;2f&nbsp;&nbsp;...</code></div></div></td></tr></tbody></table></div></div><br>
<br>
<br>



          <div marginwidth="0" marginheight="0" scrolling="no" width="100%">
              <div>
                <div id="kp_box_87" data-pid="87" data-track-view="{&quot;mod&quot;:&quot;kp_popu_87-702&quot;,&quot;con&quot;:&quot;,,&quot;}" data-track-click="{&quot;mod&quot;:&quot;kp_popu_87-702&quot;,&quot;con&quot;:&quot;,,&quot;}"><script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display: block; height: 107px; width: 708px;" data-ad-format="fluid" data-ad-layout-key="-gz+z+6i-1o-6s" data-ad-client="ca-pub-1076724771190722" data-ad-slot="4100401113" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display: inline-table; border: none; height: 107px; margin: 0px; padding: 0px; position: relative; visibility: visible; width: 708px; background-color: transparent;"><ins id="aswift_0_anchor" style="display: block; border: none; height: 107px; margin: 0px; padding: 0px; position: relative; visibility: visible; width: 708px; background-color: transparent; overflow: hidden;"><iframe width="708" height="107" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left: 0px; position: absolute; top: 0px; border: 0px; width: 708px; height: 107px;"></iframe></ins></ins></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
              </div>
          </div>
        <!-- <div class="question_wrap"><span>问题点数：</span><em>分</em></div> -->
      </div>
</body>